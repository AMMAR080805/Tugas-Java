Baik, saya akan buatkan ulang semua kode yang sudah diperbaiki, memastikan semua import sudah sesuai untuk package com.example.demo, dan secara khusus mengkonfirmasi bahwa fungsi CRUD (Create, Read, Update, Delete) sudah diimplementasikan di Controller dan Service. Saya juga akan memastikan bagian grafik di HTML berfungsi dengan baik.

Saya akan asumsikan Anda menggunakan Gradle dan telah memastikan Java versi 23 terinstal dan terdeteksi dengan benar (sesuai diskusi terakhir).

Langkah-langkah yang harus Anda lakukan:

Pastikan build.gradle Anda benar. Saya akan sertakan versi yang sudah diperbarui dengan Java 23.
Hapus folder .gradle di home directory (C:\Users\NamaPenggunaAnda\.gradle) untuk membersihkan cache global Gradle.
Hapus folder build dan .gradle di root proyek Anda (C:\Users\LQQ\Teknik Elektro Sem 2\Pemrograman 2\Tugas Java\demo\build dan C:\Users\LQQ\Teknik Elektro Sem 2\Pemrograman 2\Tugas Java\demo\.gradle).
Buat folder-folder Java di src/main/java/com/example/demo/: model, repository, service, controller.
Buat folder-folder HTML di src/main/resources/templates/: fragments, mahasiswa, kehadiran.
Tempelkan kode-kode di bawah ini ke file-file yang sesuai.
Jalankan gradlew clean build dari terminal di root proyek Anda.
Jalankan gradlew bootRun dari terminal.
1. build.gradle (File Konfigurasi Gradle)
Pastikan file ini berada di root proyek Anda.

Gradle

plugins {
    id 'java'
    id 'org.springframework.boot' version '3.2.5' // Sesuaikan dengan versi yang Anda pilih di Spring Initializr
    id 'io.spring.dependency-management' version '1.1.4' // Sesuaikan dengan versi
}

group = 'com.example'
version = '0.0.1-SNAPSHOT'

java {
    // Mengatur versi Java untuk kompilasi dan runtime
    sourceCompatibility = '23' // Menggunakan Java 23 sesuai dengan yang terinstal di sistem Anda
    targetCompatibility = '23'

    // Konfigurasi toolchain Gradle untuk memastikan penggunaan Java 23
    toolchain {
        languageVersion = JavaLanguageVersion.of(23)
    }
}

repositories {
    mavenCentral() // Repositori utama untuk mengunduh dependensi
}

dependencies {
    // Spring Boot Starters
    implementation 'org.springframework.boot:spring-boot-starter-data-jpa' // Untuk interaksi database JPA
    implementation 'org.springframework.boot:spring-boot-starter-thymeleaf' // Untuk template engine HTML
    implementation 'org.springframework.boot:spring-boot-starter-web'     // Untuk aplikasi web (REST dan MVC)

    // Database Driver
    runtimeOnly 'com.mysql:mysql-connector-j' // Driver untuk MySQL

    // Lombok (untuk mengurangi boilerplate code seperti getter/setter)
    compileOnly 'org.projectlombok:lombok'
    annotationProcessor 'org.projectlombok:lombok'

    // Spring Boot DevTools (untuk hot-reloading saat pengembangan)
    developmentOnly 'org.springframework.boot:spring-boot-devtools'

    // Testing
    testImplementation 'org.springframework.boot:spring-boot-starter-test'
}

tasks.named('test') {
    useJUnitPlatform()
}
2. src/main/resources/application.properties
Properties

# Database Configuration
spring.datasource.url=jdbc:mysql://localhost:3306/db_kehadiran_mahasiswa?useSSL=false&serverTimezone=UTC
spring.datasource.username=springuser
spring.datasource.password=password
spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver

# JPA/Hibernate Configuration
spring.jpa.hibernate.ddl-auto=update # Ganti 'update' menjadi 'none' atau 'validate' jika tabel sudah final
spring.jpa.show-sql=true
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.MySQLDialect

# Thymeleaf Configuration
spring.thymeleaf.cache=false # Untuk pengembangan
3. Package src/main/java/com/example/demo/model
Mahasiswa.java

Java

package com.example.demo.model;

import jakarta.persistence.Column;
import jakarta.persistence.Entity;
import jakarta.persistence.GeneratedValue;
import jakarta.persistence.GenerationType;
import jakarta.persistence.Id;
import jakarta.persistence.Table;
import lombok.AllArgsConstructor;
import lombok.Data;
import lombok.NoArgsConstructor;

@Entity
@Table(name = "mahasiswa")
@Data
@NoArgsConstructor
@AllArgsConstructor
public class Mahasiswa {
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;

    @Column(nullable = false, unique = true)
    private String nim;

    @Column(nullable = false)
    private String nama;

    private String jurusan;
}
Kehadiran.java

Java

package com.example.demo.model;

import jakarta.persistence.Column;
import jakarta.persistence.Entity;
import jakarta.persistence.EnumType;
import jakarta.persistence.Enumerated;
import jakarta.persistence.GeneratedValue;
import jakarta.persistence.GenerationType;
import jakarta.persistence.Id;
import jakarta.persistence.JoinColumn;
import jakarta.persistence.ManyToOne;
import jakarta.persistence.Table;
import lombok.AllArgsConstructor;
import lombok.Data;
import lombok.NoArgsConstructor;

import java.time.LocalDate;

@Entity
@Table(name = "kehadiran")
@Data
@NoArgsConstructor
@AllArgsConstructor
public class Kehadiran {
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;

    @ManyToOne
    @JoinColumn(name = "mahasiswa_id", nullable = false)
    private Mahasiswa mahasiswa;

    @Column(nullable = false)
    private LocalDate tanggal;

    @Enumerated(EnumType.STRING)
    @Column(name = "status_kehadiran", nullable = false)
    private StatusKehadiran statusKehadiran;
}
StatusKehadiran.java

Java

package com.example.demo.model;

public enum StatusKehadiran {
    Hadir,
    TidakHadir,
    Izin,
    Sakit
}
4. Package src/main/java/com/example/demo/repository
MahasiswaRepository.java

Java

package com.example.demo.repository;

import com.example.demo.model.Mahasiswa;
import org.springframework.data.jpa.repository.JpaRepository;
import org.springframework.stereotype.Repository;

@Repository
public interface MahasiswaRepository extends JpaRepository<Mahasiswa, Long> {
    Mahasiswa findByNim(String nim);
}
KehadiranRepository.java

Java

package com.example.demo.repository;

import com.example.demo.model.Kehadiran;
import com.example.demo.model.Mahasiswa;
import com.example.demo.model.StatusKehadiran;
import org.springframework.data.jpa.repository.JpaRepository;
import org.springframework.data.jpa.repository.Query;
import org.springframework.stereotype.Repository;

import java.time.LocalDate;
import java.util.List;

@Repository
public interface KehadiranRepository extends JpaRepository<Kehadiran, Long> {
    List<Kehadiran> findByMahasiswa(Mahasiswa mahasiswa);
    List<Kehadiran> findByTanggal(LocalDate tanggal);
    List<Kehadiran> findByMahasiswaAndTanggalBetween(Mahasiswa mahasiswa, LocalDate startDate, LocalDate endDate);

    @Query("SELECT k.statusKehadiran, COUNT(k) FROM Kehadiran k GROUP BY k.statusKehadiran")
    List<Object[]> countKehadiranByStatus();

    @Query("SELECT m.nama, k.statusKehadiran, COUNT(k) FROM Kehadiran k JOIN k.mahasiswa m GROUP BY m.nama, k.statusKehadiran")
    List<Object[]> countKehadiranByMahasiswaAndStatus();
}
5. Package src/main/java/com/example/demo/service
MahasiswaService.java

Java

package com.example.demo.service;

import com.example.demo.model.Mahasiswa;
import com.example.demo.repository.MahasiswaRepository;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;

import java.util.List;
import java.util.Optional;

@Service
public class MahasiswaService {

    @Autowired
    private MahasiswaRepository mahasiswaRepository;

    // READ All Mahasiswa
    public List<Mahasiswa> getAllMahasiswa() {
        return mahasiswaRepository.findAll();
    }

    // READ Mahasiswa by ID
    public Optional<Mahasiswa> getMahasiswaById(Long id) {
        return mahasiswaRepository.findById(id);
    }

    // CREATE / UPDATE Mahasiswa
    public Mahasiswa saveMahasiswa(Mahasiswa mahasiswa) {
        return mahasiswaRepository.save(mahasiswa);
    }

    // DELETE Mahasiswa
    public void deleteMahasiswa(Long id) {
        mahasiswaRepository.deleteById(id);
    }

    // UPDATE Mahasiswa (khusus untuk update, memastikan data tidak null)
    public Mahasiswa updateMahasiswa(Long id, Mahasiswa mahasiswaDetails) {
        Optional<Mahasiswa> mahasiswaOptional = mahasiswaRepository.findById(id);
        if (mahasiswaOptional.isPresent()) {
            Mahasiswa mahasiswa = mahasiswaOptional.get();
            mahasiswa.setNim(mahasiswaDetails.getNim());
            mahasiswa.setNama(mahasiswaDetails.getNama());
            mahasiswa.setJurusan(mahasiswaDetails.getJurusan());
            return mahasiswaRepository.save(mahasiswa);
        }
        return null; // Atau throw exception jika tidak ditemukan
    }

    // READ Mahasiswa by NIM
    public Mahasiswa getMahasiswaByNim(String nim) {
        return mahasiswaRepository.findByNim(nim);
    }
}
KehadiranService.java

Java

package com.example.demo.service;

import com.example.demo.model.Kehadiran;
import com.example.demo.model.Mahasiswa;
import com.example.demo.model.StatusKehadiran;
import com.example.demo.repository.KehadiranRepository;
import com.example.demo.repository.MahasiswaRepository;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;

import java.time.LocalDate;
import java.util.List;
import java.util.Map;
import java.util.Optional;
import java.util.stream.Collectors;

@Service
public class KehadiranService {

    @Autowired
    private KehadiranRepository kehadiranRepository;

    @Autowired
    private MahasiswaRepository mahasiswaRepository;

    // READ All Kehadiran
    public List<Kehadiran> getAllKehadiran() {
        return kehadiranRepository.findAll();
    }

    // READ Kehadiran by ID
    public Optional<Kehadiran> getKehadiranById(Long id) {
        return kehadiranRepository.findById(id);
    }

    // CREATE Kehadiran (membutuhkan mahasiswaId, tanggal, status)
    public Kehadiran saveKehadiran(Long mahasiswaId, LocalDate tanggal, StatusKehadiran statusKehadiran) {
        Optional<Mahasiswa> mahasiswaOptional = mahasiswaRepository.findById(mahasiswaId);
        if (mahasiswaOptional.isPresent()) {
            Kehadiran kehadiran = new Kehadiran();
            kehadiran.setMahasiswa(mahasiswaOptional.get());
            kehadiran.setTanggal(tanggal);
            kehadiran.setStatusKehadiran(statusKehadiran);
            return kehadiranRepository.save(kehadiran);
        }
        return null; // Atau throw exception
    }

    // DELETE Kehadiran
    public void deleteKehadiran(Long id) {
        kehadiranRepository.deleteById(id);
    }

    // UPDATE Kehadiran (membutuhkan semua detail, termasuk ID kehadiran)
    public Kehadiran updateKehadiran(Long id, Long mahasiswaId, LocalDate tanggal, StatusKehadiran statusKehadiran) {
        Optional<Kehadiran> kehadiranOptional = kehadiranRepository.findById(id);
        Optional<Mahasiswa> mahasiswaOptional = mahasiswaRepository.findById(mahasiswaId);

        if (kehadiranOptional.isPresent() && mahasiswaOptional.isPresent()) {
            Kehadiran kehadiran = kehadiranOptional.get();
            kehadiran.setMahasiswa(mahasiswaOptional.get());
            kehadiran.setTanggal(tanggal);
            kehadiran.setStatusKehadiran(statusKehadiran);
            return kehadiranRepository.save(kehadiran);
        }
        return null; // Atau throw exception
    }

    // READ Kehadiran by Mahasiswa
    public List<Kehadiran> getKehadiranByMahasiswa(Mahasiswa mahasiswa) {
        return kehadiranRepository.findByMahasiswa(mahasiswa);
    }

    // READ Kehadiran by Tanggal
    public List<Kehadiran> getKehadiranByTanggal(LocalDate tanggal) {
        return kehadiranRepository.findByTanggal(tanggal);
    }

    // Method untuk Grafik: Menghitung Kehadiran Berdasarkan Status
    public Map<String, Long> getKehadiranCountByStatus() {
        List<Object[]> results = kehadiranRepository.countKehadiranByStatus();
        return results.stream()
                .collect(Collectors.toMap(
                        row -> ((StatusKehadiran) row[0]).name(), // Nama status (Hadir, TidakHadir, dll.)
                        row -> ((Number) row[1]).longValue() // Jumlah
                ));
    }

    // Method untuk Grafik: Menghitung Kehadiran Berdasarkan Mahasiswa dan Status
    public Map<String, Map<String, Long>> getKehadiranCountByMahasiswaAndStatus() {
        List<Object[]> results = kehadiranRepository.countKehadiranByMahasiswaAndStatus();
        return results.stream()
                .collect(Collectors.groupingBy(
                        row -> (String) row[0], // Mahasiswa nama
                        Collectors.toMap(
                                row -> ((StatusKehadiran) row[1]).name(), // Status kehadiran
                                row -> ((Number) row[2]).longValue() // Count
                        )
                ));
    }
}
6. Package src/main/java/com/example/demo/controller
MahasiswaController.java

Java

package com.example.demo.controller;

import com.example.demo.model.Mahasiswa;
import com.example.demo.service.MahasiswaService;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.web.bind.annotation.*;
import org.springframework.web.servlet.mvc.support.RedirectAttributes;

import java.util.List;

@Controller
@RequestMapping("/mahasiswa")
public class MahasiswaController {

    @Autowired
    private MahasiswaService mahasiswaService;

    // READ All: Menampilkan daftar mahasiswa dan form tambah/edit
    @GetMapping
    public String listMahasiswa(Model model) {
        List<Mahasiswa> mahasiswaList = mahasiswaService.getAllMahasiswa();
        model.addAttribute("mahasiswaList", mahasiswaList);
        // Inisialisasi objek mahasiswa baru untuk form tambah
        model.addAttribute("mahasiswa", new Mahasiswa());
        return "mahasiswa/list"; // Akan merender src/main/resources/templates/mahasiswa/list.html
    }

    // CREATE: Menambah mahasiswa baru
    @PostMapping("/add")
    public String addMahasiswa(@ModelAttribute Mahasiswa mahasiswa, RedirectAttributes redirectAttributes) {
        // Cek duplikasi NIM sebelum menyimpan
        Mahasiswa existingMahasiswa = mahasiswaService.getMahasiswaByNim(mahasiswa.getNim());
        if (existingMahasiswa != null && (mahasiswa.getId() == null || !mahasiswa.getId().equals(existingMahasiswa.getId()))) {
            redirectAttributes.addFlashAttribute("errorMessage", "NIM " + mahasiswa.getNim() + " sudah terdaftar!");
        } else {
            mahasiswaService.saveMahasiswa(mahasiswa);
            redirectAttributes.addFlashAttribute("successMessage", "Mahasiswa berhasil disimpan!");
        }
        return "redirect:/mahasiswa";
    }

    // READ (for Edit): Mengisi form dengan data mahasiswa yang akan diedit
    @GetMapping("/edit/{id}")
    public String editMahasiswaForm(@PathVariable Long id, Model model, RedirectAttributes redirectAttributes) {
        mahasiswaService.getMahasiswaById(id).ifPresentOrElse(
                mahasiswa -> model.addAttribute("mahasiswa", mahasiswa),
                () -> redirectAttributes.addFlashAttribute("errorMessage", "Mahasiswa tidak ditemukan!"));

        // Pastikan daftar mahasiswa juga tersedia saat melakukan edit, karena form edit berada di halaman yang sama
        model.addAttribute("mahasiswaList", mahasiswaService.getAllMahasiswa());
        return "mahasiswa/list"; // Tetap di halaman list, tapi form akan terisi untuk edit
    }

    // UPDATE: Memperbarui data mahasiswa yang sudah ada
    @PostMapping("/update/{id}")
    public String updateMahasiswa(@PathVariable Long id, @ModelAttribute Mahasiswa mahasiswa, RedirectAttributes redirectAttributes) {
        // Periksa NIM duplikat kecuali jika itu adalah NIM dari mahasiswa yang sedang diedit
        Mahasiswa existingMahasiswa = mahasiswaService.getMahasiswaByNim(mahasiswa.getNim());
        if (existingMahasiswa != null && !existingMahasiswa.getId().equals(id)) {
            redirectAttributes.addFlashAttribute("errorMessage", "NIM " + mahasiswa.getNim() + " sudah terdaftar!");
        } else {
            if (mahasiswaService.updateMahasiswa(id, mahasiswa) != null) {
                redirectAttributes.addFlashAttribute("successMessage", "Mahasiswa berhasil diperbarui!");
            } else {
                redirectAttributes.addFlashAttribute("errorMessage", "Gagal memperbarui mahasiswa!");
            }
        }
        return "redirect:/mahasiswa";
    }

    // DELETE: Menghapus data mahasiswa
    @GetMapping("/delete/{id}")
    public String deleteMahasiswa(@PathVariable Long id, RedirectAttributes redirectAttributes) {
        mahasiswaService.deleteMahasiswa(id);
        redirectAttributes.addFlashAttribute("successMessage", "Mahasiswa berhasil dihapus!");
        return "redirect:/mahasiswa";
    }
}
KehadiranController.java

Java

package com.example.demo.controller;

import com.example.demo.model.Kehadiran;
import com.example.demo.model.Mahasiswa;
import com.example.demo.model.StatusKehadiran;
import com.example.demo.service.KehadiranService;
import com.example.demo.service.MahasiswaService;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.web.bind.annotation.*;
import org.springframework.web.servlet.mvc.support.RedirectAttributes;

import java.time.LocalDate;
import java.util.List;
import java.util.Map;

@Controller
@RequestMapping("/kehadiran")
public class KehadiranController {

    @Autowired
    private KehadiranService kehadiranService;

    @Autowired
    private MahasiswaService mahasiswaService;

    // READ All: Menampilkan daftar kehadiran, form tambah/edit, dan data grafik
    @GetMapping
    public String listKehadiran(Model model) {
        List<Kehadiran> kehadiranList = kehadiranService.getAllKehadiran();
        List<Mahasiswa> mahasiswaList = mahasiswaService.getAllMahasiswa();
        model.addAttribute("kehadiranList", kehadiranList);
        model.addAttribute("mahasiswaList", mahasiswaList);
        // Inisialisasi objek kehadiran baru untuk form tambah
        model.addAttribute("kehadiran", new Kehadiran());
        model.addAttribute("statusKehadiranOptions", StatusKehadiran.values());

        // Data untuk grafik
        Map<String, Long> kehadiranByStatus = kehadiranService.getKehadiranCountByStatus();
        model.addAttribute("kehadiranByStatus", kehadiranByStatus);

        Map<String, Map<String, Long>> kehadiranByMahasiswaAndStatus = kehadiranService.getKehadiranCountByMahasiswaAndStatus();
        model.addAttribute("kehadiranByMahasiswaAndStatus", kehadiranByMahasiswaAndStatus);

        return "kehadiran/list";
    }

    // CREATE: Menambah data kehadiran baru
    @PostMapping("/add")
    public String addKehadiran(@RequestParam Long mahasiswaId,
                               @RequestParam LocalDate tanggal,
                               @RequestParam StatusKehadiran statusKehadiran,
                               RedirectAttributes redirectAttributes) {
        if (kehadiranService.saveKehadiran(mahasiswaId, tanggal, statusKehadiran) != null) {
            redirectAttributes.addFlashAttribute("successMessage", "Kehadiran berhasil disimpan!");
        } else {
            redirectAttributes.addFlashAttribute("errorMessage", "Gagal menyimpan kehadiran. Mahasiswa tidak ditemukan.");
        }
        return "redirect:/kehadiran";
    }

    // READ (for Edit): Mengisi form dengan data kehadiran yang akan diedit
    @GetMapping("/edit/{id}")
    public String editKehadiranForm(@PathVariable Long id, Model model, RedirectAttributes redirectAttributes) {
        kehadiranService.getKehadiranById(id).ifPresentOrElse(
                kehadiran -> model.addAttribute("kehadiran", kehadiran),
                () -> redirectAttributes.addFlashAttribute("errorMessage", "Data kehadiran tidak ditemukan!"));

        // Pastikan daftar kehadiran, mahasiswa, dan opsi status juga tersedia
        // saat melakukan edit, karena form edit berada di halaman yang sama
        model.addAttribute("kehadiranList", kehadiranService.getAllKehadiran());
        model.addAttribute("mahasiswaList", mahasiswaService.getAllMahasiswa());
        model.addAttribute("statusKehadiranOptions", StatusKehadiran.values());

        // Data untuk grafik juga harus disertakan jika form edit ada di halaman yang sama
        Map<String, Long> kehadiranByStatus = kehadiranService.getKehadiranCountByStatus();
        model.addAttribute("kehadiranByStatus", kehadiranByStatus);
        Map<String, Map<String, Long>> kehadiranByMahasiswaAndStatus = kehadiranService.getKehadiranCountByMahasiswaAndStatus();
        model.addAttribute("kehadiranByMahasiswaAndStatus", kehadiranByMahasiswaAndStatus);

        return "kehadiran/list";
    }

    // UPDATE: Memperbarui data kehadiran yang sudah ada
    @PostMapping("/update/{id}")
    public String updateKehadiran(@PathVariable Long id,
                                  @RequestParam Long mahasiswaId,
                                                                      @RequestParam LocalDate tanggal,
                                                                      @RequestParam StatusKehadiran statusKehadiran,
                                                                      RedirectAttributes redirectAttributes) {
        if (kehadiranService.updateKehadiran(id, mahasiswaId, tanggal, statusKehadiran) != null) {
            redirectAttributes.addFlashAttribute("successMessage", "Kehadiran berhasil diperbarui!");
        } else {
            redirectAttributes.addFlashAttribute("errorMessage", "Gagal memperbarui kehadiran. Data tidak ditemukan atau mahasiswa tidak valid.");
        }
        return "redirect:/kehadiran";
    }

    // DELETE: Menghapus data kehadiran
    @GetMapping("/delete/{id}")
    public String deleteKehadiran(@PathVariable Long id, RedirectAttributes redirectAttributes) {
        kehadiranService.deleteKehadiran(id);
        redirectAttributes.addFlashAttribute("successMessage", "Kehadiran berhasil dihapus!");
        return "redirect:/kehadiran";
    }
}
7. Main Application Class (DemoApplication.java)
Pastikan ini di src/main/java/com/example/demo/.

Java

package com.example.demo;

import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;

@SpringBootApplication
public class DemoApplication {

    public static void main(String[] args) {
        SpringApplication.run(DemoApplication.class, args);
    }

}
8. File HTML Thymeleaf di src/main/resources/templates
src/main/resources/templates/fragments/navbar.html

HTML

<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Navbar</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
</head>
<body>
<nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
    <a class="navbar-brand" th:href="@{/}">Kehadiran Mahasiswa</a>
    <div class="collapse navbar-collapse">
        <ul class="navbar-nav mr-auto">
            <li class="nav-item">
                <a class="nav-link" th:href="@{/mahasiswa}">Data Mahasiswa</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" th:href="@{/kehadiran}">Data Kehadiran & Grafik</a>
            </li>
        </ul>
    </div>
</nav>
</body>
</html>
src/main/resources/templates/layout.html

HTML

<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title th:text="${title} ?: 'Aplikasi Kehadiran Mahasiswa'"></title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            padding-top: 70px; /* Adjust based on navbar height */
        }
        .container {
            margin-top: 20px;
        }
        .message-container {
            margin-bottom: 20px;
        }
        .chart-container {
            position: relative;
            height: 350px; /* Tinggi tetap untuk chart agar responsif */
            width: 100%;
            margin-bottom: 20px; /* Spasi antar chart */
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 400px;
            }
        }
    </style>
</head>
<body>
    <div th:replace="~{fragments/navbar :: navbar}"></div>

    <div class="container">
        <div class="message-container">
            <div th:if="${successMessage}" class="alert alert-success" role="alert">
                <p th:text="${successMessage}"></p>
            </div>
            <div th:if="${errorMessage}" class="alert alert-danger" role="alert">
                <p th:text="${errorMessage}"></p>
            </div>
        </div>

        <div layout:fragment="content">
            </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.4/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
</body>
</html>
src/main/resources/templates/mahasiswa/list.html

    <!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"
xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
layout:decorate="~{layout}">
<head>
<meta charset="UTF-8">
<title>Data Mahasiswa</title>
</head>
<body>
<div layout:fragment="content">
<h2>Data Mahasiswa</h2>

    <form th:action="${mahasiswa.id == null ? '/mahasiswa/add' : '/mahasiswa/update/' + mahasiswa.id}" method="post" class="mb-4">
        <input type="hidden" th:field="*{mahasiswa.id}" />
        <div class="form-group">
            <label for="nim">NIM:</label>
            <input type="text" id="nim" name="nim" th:field="*{mahasiswa.nim}" class="form-control" required>
        </div>
        <div class="form-group">
            <label for="nama">Nama:</label>
            <input type="text" id="nama" name="nama" th:field="*{mahasiswa.nama}" class="form-control" required>
        </div>
        <div class="form-group">
            <label for="jurusan">Jurusan:</label>
            <input type="text" id="jurusan" name="jurusan" th:field="*{mahasiswa.jurusan}" class="form-control">
        </div>
        <button type="submit" class="btn btn-primary" th:text="${mahasiswa.id == null ? 'Tambah Mahasiswa' : 'Update Mahasiswa'}"></button>
        <a th:if="${mahasiswa.id != null}" th:href="@{/mahasiswa}" class="btn btn-secondary ml-2">Batal</a>
    </form>

    <hr>

    <h3>Daftar Mahasiswa</h3>
    <table class="table table-striped">
        <thead>
        <tr>
            <th>ID</th>
            <th>NIM</th>
            <th>Nama</th>
            <th>Jurusan</th>
            <th>Aksi</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="m : ${mahasiswaList}">
            <td th:text="${m.id}"></td>
            <td th:text="${m.nim}"></td>
            <td th:text="${m.nama}"></td>
            <td th:text="${m.jurusan}"></td>
            <td>
                <a th:href="@{/mahasiswa/edit/{id}(id=${m.id})}" class="btn btn-warning btn-sm">Edit</a>
                <a th:href="@{/mahasiswa/delete/{id}(id=${m.id})}" class="btn btn-danger btn-sm" onclick="return confirm('Apakah Anda yakin ingin menghapus data ini?');">Hapus</a>
            </td>
        </tr>
        </tbody>
    </table>
</div>
</body>
<script th:inline="javascript">
    /*<![CDATA[*/
    var kehadiranByStatusData = /*[[${kehadiranByStatus}]]*/ {};
    var kehadiranByMahasiswaAndStatusData = /*[[${kehadiranByMahasiswaAndStatus}]]*/ {};

    // Chart 1: Kehadiran Berdasarkan Status (Pie Chart)
    var statusLabels = Object.keys(kehadiranByStatusData);
    var statusCounts = Object.values(kehadiranByStatusData);
    // Warna yang lebih menarik untuk grafik
    var statusColors = [
        'rgba(75, 192, 192, 0.8)', // Hadir (Turquoise)
        'rgba(255, 159, 64, 0.8)', // Tidak Hadir (Orange)
        'rgba(54, 162, 235, 0.8)', // Izin (Blue)
        'rgba(255, 99, 132, 0.8)'  // Sakit (Red)
    ];
    var statusBorderColors = [
        'rgba(75, 192, 192, 1)',
        'rgba(255, 159, 64, 1)',
        'rgba(54, 162, 235, 1)',
        'rgba(255, 99, 132, 1)'
    ];

    var ctx1 = document.getElementById('kehadiranByStatusChart').getContext('2d');
    new Chart(ctx1, {
        type: 'pie',
        data: {
            labels: statusLabels,
            datasets: [{
                data: statusCounts,
                backgroundColor: statusColors,
                borderColor: statusBorderColors,
                borderWidth: 1
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    position: 'top',
                    labels: {
                        font: {
                            size: 14 // Ukuran font legend
                        }
                    }
                },
                title: {
                    display: true,
                    text: 'Distribusi Status Kehadiran',
                    font: {
                        size: 16, // Ukuran font judul
                        weight: 'bold'
                    }
                }
            }
        }
    });

    // Chart 2: Kehadiran Berdasarkan Mahasiswa dan Status (Stacked Bar Chart)
    var mahasiswaNames = Object.keys(kehadiranByMahasiswaAndStatusData);
    var datasetMap = {};

    statusLabels.forEach((status, index) => {
        datasetMap[status] = {
            label: status,
            data: [],
            backgroundColor: statusColors[index],
            borderColor: statusBorderColors[index],
            borderWidth: 1,
            stack: 'Stack 1'
        };
    });

    var datasetsForChart2 = Object.values(datasetMap);

    var ctx2 = document.getElementById('kehadiranByMahasiswaAndStatusChart').getContext('2d');
    new Chart(ctx2, {
        type: 'bar',
        data: {
            labels: mahasiswaNames,
            datasets: datasetsForChart2
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    position: 'top',
                    labels: {
                        font: {
                            size: 14
                        }
                    }
                },
                title: {
                    display: true,
                    text: 'Kehadiran per Mahasiswa dan Status',
                    font: {
                        size: 16,
                        weight: 'bold'
                    }
                }
            },
            scales: {
                x: {
                    stacked: true,
                    title: {
                        display: true,
                        text: 'Nama Mahasiswa',
                        font: {
                            size: 14
                        }
                    },
                    ticks: {
                        font: {
                            size: 12
                        }
                    }
                },
                y: {
                    stacked: true,
                    beginAtZero: true,
                    title: {
                        display: true,
                        text: 'Jumlah Kehadiran',
                        font: {
                            size: 14
                        }
                    },
                    ticks: {
                        font: {
                            size: 12
                        }
                    }
                }
            }
        }
    });
    /*]]>*/
</script>
</html>